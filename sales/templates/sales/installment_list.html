{% extends 'base.html' %}
{% block title %}Installments{% endblock %}
{% block content %}
<h1 class="text-2xl font-semibold mb-4">Installment Plans</h1>
<div class="bg-white rounded shadow overflow-hidden">
  <table class="w-full">
    <thead class="bg-gray-50">
      <tr>
        <th class="text-left p-3">Sale #</th>
        <th class="text-left p-3">Customer</th>
        <th class="text-left p-3">Status</th>
        <th class="text-left p-3">Installments</th>
        <th class="text-left p-3">Installment Amount</th>
        <th class="text-left p-3">Paid</th>
        <th class="text-left p-3">Outstanding</th>
        <th class="p-3"></th>
      </tr>
    </thead>
    <tbody>
      {% for row in page_obj.object_list %}
      <tr class="border-t">
        <td class="p-3">{{ row.plan.sale.id }}</td>
        <td class="p-3">{{ row.plan.sale.customer.name }}</td>
        <td class="p-3">
          <span class="inline-block px-2 py-1 rounded text-xs {% if row.plan.status == 'PAID' %}bg-green-100 text-green-800{% else %}bg-yellow-100 text-yellow-800{% endif %}">
            {{ row.plan.get_status_display }}
          </span>
        </td>
        <td class="p-3">{{ row.plan.total_installments }}</td>
        <td class="p-3">Rs {{ row.plan.installment_amount }}</td>
        <td class="p-3">Rs {{ row.paid }}</td>
        <td class="p-3">Rs {{ row.outstanding }}</td>
        <td class="p-3 text-right"><a href="{% url 'sales:sale_detail' row.plan.sale.id %}" class="text-blue-600">View</a></td>
      </tr>
      {% empty %}
      <tr><td colspan="8" class="p-4 text-center">No installment plans.</td></tr>
      {% endfor %}
    </tbody>
  </table>
</div>
<!-- Pagination -->
<div class="mt-6 flex justify-center gap-2">
  {% if page_obj.has_previous %}
    <a href="?page={{ page_obj.previous_page_number }}" class="px-3 py-1 border rounded">Prev</a>
  {% endif %}
  <span class="px-3 py-1">Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</span>
  {% if page_obj.has_next %}
    <a href="?page={{ page_obj.next_page_number }}" class="px-3 py-1 border rounded">Next</a>
  {% endif %}
</div>
{% endblock %}
